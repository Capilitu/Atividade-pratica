<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Gerenciador de Tarefas</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body class="container mt-5">
  <h1>Gerenciador de Tarefas</h1>
  <form id="taskForm">
    <input type="text" id="title" class="form-control mb-2" placeholder="Título" required>
    <input type="text" id="description" class="form-control mb-2" placeholder="Descrição">
    <input type="datetime-local" id="date" class="form-control mb-2">
    
    <button class="btn btn-primary">Criar Tarefa</button>
  </form>
  <ul id="taskList" class="mt-4"></ul>

  <script>
    const form = document.getElementById('taskForm');
const list = document.getElementById('taskList');

form.onsubmit = async (e) => {
  e.preventDefault();

  const task = {
    title: title.value,
    description: description.value,
    date: date.value
  };

  const res = await fetch('/api/tasks', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(task)
  });

  const data = await res.json();
  const selectedDate = new Date(data.date).toLocaleString();

  list.innerHTML += `<li>
    <strong>${data.title}</strong><br>
    ${data.description}<br>
    ${selectedDate}
    <button onclick="remove('${data._id}')">Remover</button>
  </li>`;
};

async function remove(id) {
  await fetch(`/api/tasks/${id}`, { method: 'DELETE' });
  location.reload();
}

(async function loadTasks() {
  const res = await fetch('/api/tasks');
  const tasks = await res.json();

  tasks.forEach(t => {
    const selectedDate = new Date(t.date).toLocaleString();
    list.innerHTML += `<li>
      <strong>${t.title}</strong><br>
      ${t.description}<br>
      ${selectedDate}
      <button onclick="remove('${t._id}')">Remover</button>
    </li>`;
  });
})();
  </script>
</body>
</html>